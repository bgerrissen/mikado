(function(){var L={},F=0,a=this,Z=a.document,A=Z.documentElement,f={timeout:1500,root:function(){var k=Z.getElementsByTagName("script"),g=0,h=/\/mikado[^\/\\]*\.js.?$/i,j;while((j=k[g++])){if(h.test(j.src)){return j.src.replace(h,"")}}}(),scriptLocation:Z.getElementsByTagName("head")[0],repositories:{},force:{}},H={},I={},e={},Y=Z.createElement("script");Y.type="text/javascript";var P=function(){},X=Array.prototype.slice,J=function(){var g={};return{add:function(h,i){if(!g[h]){g[h]=[]}g[h].unshift(i)},remove:function(j,l){var k=g[j],h;if(k){h=k.length;while(h--){if(k[h]===l){k.splice(h,1)}}}},clear:function(h){if(h&&g[h]){delete g[h]}},dispatch:function(j){console.log("dispatching event -> "+j);var k=g[j],h;if(k){h=k.length;while(h--){k[h](j)}}}}},O=(function(){var g=J();var h=function(i){if(i&&!i.nextSibling){Z.body.removeChild(i);F=1;g.dispatch("domReady");return(g=i=null)}else{if(i){Z.body.removeChild(i);i=null}else{if(Z.body){i=Z.body.appendChild(Z.createElement("span"))}}}setTimeout(function(){h(i)})};h();return function(i){if(!F){g.add("domReady",i)}else{i()}}})(),U=J(),c=function(i){if(/^.*:/.test(i)){var h=i.replace(/:.*$/,""),g=f.repositories[h];if(!g){throw"Error @ mikado->internal 'createFullPath' : No repository set for '"+h+":'"}i=i.replace(/^.*:/,"").replace(/\./g,"/")+".js";return g+i}else{return f.root+"/"+i.replace(/\./g,"/")+".js"}},C=function(g){if(!g.fetch||!g.fetch.length){return false}var j=g.fetch;g.dependencyTracker=function(m){var l=j.length;while(l--){if(j[l]===m){j.splice(l,1)}}if(!j.length){K(g);U.remove(m,g.dependencyTracker);delete g.dependencyTracker}};var h=j.length,k;while(h--){k=j[h];if(L[k]){j.splice(h,1);continue}U.add(k,g.dependencyTracker);if(!I[k]){N(k,g.timeout)}I[k].push(g)}return true},N=function(h,g){if(L[h]){return false}if(!I[h]){I[h]=[]}H[h]=Y.cloneNode(false);H[h].src=c(h);f.scriptLocation.appendChild(H[h]);G(h,g);return true},Q=function(l,h){var k=h?"DEPENDENCY ":"";h=h||"TIMED OUT ["+l+"] @ "+e[l].timeout+"ms";H[l].type=k+h;var j=I[l],g=j.length;U.clear(l);while(g--){Q(j[g].path,h);delete j[g]}delete I[l]},G=function(h,g){if(!f.timeout){return false}g=g?Math.max(g,f.timeout):f.timeout;e[h]={timeout:g,timeoutID:setTimeout(function(){Q(h)},g)};return true},E=function(g){clearInterval(e[g].timeoutID)},T=function(g){return g?g.split(".").pop():null},B=function(j){var h=j.length,g;while(h--){g=T(j[h]);if(g&&f.force[g]){j[h]=f.force[g]}}},V=function(g){g.fetch=g.fetch||[];if(g.include instanceof Array){g.fetch=g.fetch.concat(g.include)}B(g.fetch)},d=function(g){if(g.allow instanceof Array){var h=g.allow,i;g.allow={};while((i=h.pop())){g.allow[i]=true}}},W=function(j){console.log(j);var l=j.include,k=l.length,h=j.path,g,m;j.library={};while(k--){m=l[k];g=L[m];if(g.allow&&!g.allow[h]){j.library[g.name]="Access denied!";continue}j.hasDomTool=j.hasDomTool||g.domTool||g.hasDomTool||false;if(g.module){j.library[g.name]=g.module}}},D=function(g){var h=g.name||T(g.path),k=g.path||h;if(I[k]){return }var j=[],i;for(i in I){if(h==T(i)){j.push(i)}}if(j.length===1){g.path=j[0]}else{throw"ERROR: could not resolve incorrect path: '"+k+"'"}},M=function(g){D(g);E(g.path);g.name=g.name||T(g.path);d(g);V(g);if(!C(g)){K(g)}},K=function(g){if(g.domBuild&&!F){O(function(){K(g)});return false}if(g.include instanceof Array){W(g)}if(typeof g.build=="function"){g.module=g.build(g.library);delete g.build}L[g.path]=g;U.dispatch(g.path);R(g.path)},R=function(g){delete I[g];delete e[g];H[g].parentNode.removeChild(H[g]);delete H[g]},b=function(h,i){if(h.hasDomTool&&!F){return O(function(){b(h,i)})}var j=h.module;if(typeof j=="function"){P.prototype=j.prototype;var g=new P();j.apply(g,i)}},S={module:function(g){M(g)},run:function(i){var h=X.call(arguments,1),g=L[i];if(!g){U.add(i,function(j){b(L[j],h)});N(i)}else{b(g,h)}return this},fetch:function(j,h){if(j instanceof Array){var g=j.length;while(g--){N(j[g],h)}}return this},available:function(g){return !!L[g]},config:function(i){for(var h in i){if(/(?:repositories|force)/.test(h)){for(var g in i[h]){if(typeof i[h][g]=="string"){f[h][g]=i[h][g]}}}else{if(f[h]){f[h]=i[h]}}}return this}};a.mikado=S})();